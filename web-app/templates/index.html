<!DOCTYPE html>
<html>
  <head>
    <title>How are you feeling?</title>
    <link rel="stylesheet" href="{{url_for('static', filename='home.css') }}" />
    <link rel="stylesheet" href="https://unpkg.com/98.css" />
    <script>
      function captureImage() {
        var video = document.querySelector("#videoElement");
        var canvas = document.createElement("canvas");
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        var ctx = canvas.getContext("2d");
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
        return canvas.toDataURL();
      }

      function sendImage() {
        var imageData = captureImage();
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "http://localhost:3000/image", true);
        xhr.setRequestHeader("Content-Type", "application/json");
        xhr.onreadystatechange = function () {
          if (xhr.readyState == 4 && xhr.status == 200) {
            var response = JSON.parse(xhr.responseText);
            displayResult(response);
          }
        };
        xhr.send(JSON.stringify({ image: imageData }));
      }

      function displayResult(data) {
        var resultDiv = document.getElementById("result");
        resultDiv.innerHTML =
          "<pre>" + JSON.stringify(data, null, 2) + "</pre>";
      }
    </script>
  </head>
  <body>
    <video id="videoElement" autoplay></video>
    <button onclick="sendImage()">How are ya doing</button>
    <button onclick="sendImage()">How are ya doing</button>
    <button onclick="sendImage()">How are ya doing</button>
    <button onclick="sendImage()">How are ya doing</button>
    <button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button>
    <button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button
    ><button onclick="sendImage()">How are ya doing</button>
    <div id="result"></div>

    <script>
      var video = document.querySelector("#videoElement");
      if (navigator.mediaDevices.getUserMedia) {
        navigator.mediaDevices
          .getUserMedia({ video: true })
          .then(function (stream) {
            video.srcObject = stream;
          })
          .catch(function (error) {
            console.log("Something went wrong!");
          });
      }
    </script>
  </body>
</html>
